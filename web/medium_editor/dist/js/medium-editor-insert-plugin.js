this.MediumInsert=this.MediumInsert||{},this.MediumInsert.Templates=this.MediumInsert.Templates||{},this.MediumInsert.Templates["src/js/templates/core-buttons.hbs"]=Handlebars.template({1:function(e,t,i,s,o){var n,a,r=null!=t?t:{},l=i.helperMissing,d="function";return'            <li><a data-addon="'+e.escapeExpression((a=null!=(a=i.key||o&&o.key)?a:l,typeof a===d?a.call(r,{name:"key",hash:{},data:o}):a))+'" data-action="add" class="medium-insert-action">'+(null!=(a=null!=(a=i.label||(null!=t?t.label:t))?a:l,n=typeof a===d?a.call(r,{name:"label",hash:{},data:o}):a)?n:"")+"</a></li>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,i,s,o){var n;return'<div class="medium-insert-buttons" contenteditable="false" style="display: none">\n    <a class="medium-insert-buttons-show">+</a>\n    <ul class="medium-insert-buttons-addons" style="display: none">\n'+(null!=(n=i.each.call(null!=t?t:{},null!=t?t.addons:t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o}))?n:"")+"    </ul>\n</div>\n"},useData:!0}),this.MediumInsert.Templates["src/js/templates/core-caption.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(e,t,i,s,o){var n;return'<figcaption contenteditable="true" class="medium-insert-caption-placeholder" data-placeholder="'+e.escapeExpression((n=null!=(n=i.placeholder||(null!=t?t.placeholder:t))?n:i.helperMissing,"function"==typeof n?n.call(null!=t?t:{},{name:"placeholder",hash:{},data:o}):n))+'"></figcaption>'},useData:!0}),this.MediumInsert.Templates["src/js/templates/core-empty-line.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(e,t,i,s,o){return"<p><br></p>\n"},useData:!0}),this.MediumInsert.Templates["src/js/templates/embeds-toolbar.hbs"]=Handlebars.template({1:function(e,t,i,s,o){var n;return'    <div class="medium-insert-embeds-toolbar medium-editor-toolbar medium-toolbar-arrow-under medium-editor-toolbar-active">\n        <ul class="medium-editor-toolbar-actions clearfix">\n'+(null!=(n=i.each.call(null!=t?t:{},null!=t?t.styles:t,{name:"each",hash:{},fn:e.program(2,o,0),inverse:e.noop,data:o}))?n:"")+"        </ul>\n    </div>\n"},2:function(e,t,i,s,o){var n;return null!=(n=i["if"].call(null!=t?t:{},null!=t?t.label:t,{name:"if",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o}))?n:""},3:function(e,t,i,s,o){var n,a,r=null!=t?t:{},l=i.helperMissing,d="function";return'                    <li>\n                        <button class="medium-editor-action" data-action="'+e.escapeExpression((a=null!=(a=i.key||o&&o.key)?a:l,typeof a===d?a.call(r,{name:"key",hash:{},data:o}):a))+'">'+(null!=(a=null!=(a=i.label||(null!=t?t.label:t))?a:l,n=typeof a===d?a.call(r,{name:"label",hash:{},data:o}):a)?n:"")+"</button>\n                    </li>\n"},5:function(e,t,i,s,o){var n;return'    <div class="medium-insert-embeds-toolbar2 medium-editor-toolbar medium-editor-toolbar-active">\n        <ul class="medium-editor-toolbar-actions clearfix">\n'+(null!=(n=i.each.call(null!=t?t:{},null!=t?t.actions:t,{name:"each",hash:{},fn:e.program(2,o,0),inverse:e.noop,data:o}))?n:"")+"        </ul>\n    </div>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,i,s,o){var n,a=null!=t?t:{};return(null!=(n=i["if"].call(a,null!=t?t.styles:t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o}))?n:"")+"\n"+(null!=(n=i["if"].call(a,null!=t?t.actions:t,{name:"if",hash:{},fn:e.program(5,o,0),inverse:e.noop,data:o}))?n:"")},useData:!0}),this.MediumInsert.Templates["src/js/templates/embeds-wrapper.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(e,t,i,s,o){var n,a;return'<div class="medium-insert-embeds" contenteditable="false">\n	<figure>\n		<div class="medium-insert-embed">\n			'+(null!=(a=null!=(a=i.html||(null!=t?t.html:t))?a:i.helperMissing,n="function"==typeof a?a.call(null!=t?t:{},{name:"html",hash:{},data:o}):a)?n:"")+'\n		</div>\n	</figure>\n	<div class="medium-insert-embeds-overlay"></div>\n</div>'},useData:!0}),this.MediumInsert.Templates["src/js/templates/images-fileupload.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(e,t,i,s,o){return'<input type="file" multiple>'},useData:!0}),this.MediumInsert.Templates["src/js/templates/images-image.hbs"]=Handlebars.template({1:function(e,t,i,s,o){return'        <div class="medium-insert-images-progress"></div>\n'},compiler:[7,">= 4.0.0"],main:function(e,t,i,s,o){var n,a,r=null!=t?t:{};return'<figure contenteditable="false">\n    <img src="'+e.escapeExpression((a=null!=(a=i.img||(null!=t?t.img:t))?a:i.helperMissing,"function"==typeof a?a.call(r,{name:"img",hash:{},data:o}):a))+'" alt="">\n'+(null!=(n=i["if"].call(r,null!=t?t.progress:t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o}))?n:"")+"</figure>"},useData:!0}),this.MediumInsert.Templates["src/js/templates/images-progressbar.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(e,t,i,s,o){return'<progress min="0" max="100" value="0">0</progress>'},useData:!0}),this.MediumInsert.Templates["src/js/templates/images-toolbar.hbs"]=Handlebars.template({1:function(e,t,i,s,o){var n;return null!=(n=i["if"].call(null!=t?t:{},null!=t?t.label:t,{name:"if",hash:{},fn:e.program(2,o,0),inverse:e.noop,data:o}))?n:""},2:function(e,t,i,s,o){var n,a,r=null!=t?t:{},l=i.helperMissing,d="function";return'                <li>\n                    <button class="medium-editor-action" data-action="'+e.escapeExpression((a=null!=(a=i.key||o&&o.key)?a:l,typeof a===d?a.call(r,{name:"key",hash:{},data:o}):a))+'">'+(null!=(a=null!=(a=i.label||(null!=t?t.label:t))?a:l,n=typeof a===d?a.call(r,{name:"label",hash:{},data:o}):a)?n:"")+"</button>\n                </li>\n"},4:function(e,t,i,s,o){var n;return'	<div class="medium-insert-images-toolbar2 medium-editor-toolbar medium-editor-toolbar-active">\n		<ul class="medium-editor-toolbar-actions clearfix">\n'+(null!=(n=i.each.call(null!=t?t:{},null!=t?t.actions:t,{name:"each",hash:{},fn:e.program(5,o,0),inverse:e.noop,data:o}))?n:"")+"    	</ul>\n    </div>\n"},5:function(e,t,i,s,o){var n;return null!=(n=i["if"].call(null!=t?t:{},null!=t?t.label:t,{name:"if",hash:{},fn:e.program(6,o,0),inverse:e.noop,data:o}))?n:""},6:function(e,t,i,s,o){var n,a,r=null!=t?t:{},l=i.helperMissing,d="function";return'        	        <li>\n        	            <button class="medium-editor-action" data-action="'+e.escapeExpression((a=null!=(a=i.key||o&&o.key)?a:l,typeof a===d?a.call(r,{name:"key",hash:{},data:o}):a))+'">'+(null!=(a=null!=(a=i.label||(null!=t?t.label:t))?a:l,n=typeof a===d?a.call(r,{name:"label",hash:{},data:o}):a)?n:"")+"</button>\n        	        </li>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,i,s,o){var n,a=null!=t?t:{};return'<div class="medium-insert-images-toolbar medium-editor-toolbar medium-toolbar-arrow-under medium-editor-toolbar-active">\n    <ul class="medium-editor-toolbar-actions clearfix">\n'+(null!=(n=i.each.call(a,null!=t?t.styles:t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o}))?n:"")+"    </ul>\n</div>\n\n"+(null!=(n=i["if"].call(a,null!=t?t.actions:t,{name:"if",hash:{},fn:e.program(4,o,0),inverse:e.noop,data:o}))?n:"")},useData:!0}),function(e,t,i,s){"use strict";function o(e){return e.charAt(0).toUpperCase()+e.slice(1)}function n(i,s){var o;this.el=i,this.$el=e(i),this.templates=t.MediumInsert.Templates,s&&(o=s.editor,s.editor=null),this.options=e.extend(!0,{},r,s),this.options.editor=o,this._defaults=r,this._name=a,this.options&&this.options.editor&&(this.options.editor._serialize=this.options.editor.serialize,this.options.editor._destroy=this.options.editor.destroy,this.options.editor._setup=this.options.editor.setup,this.options.editor._hideInsertButtons=this.hideButtons,this.options.editor.serialize=this.editorSerialize,this.options.editor.destroy=this.editorDestroy,this.options.editor.setup=this.editorSetup,this.options.editor.getExtensionByName("placeholder").updatePlaceholder=this.editorUpdatePlaceholder)}var a="mediumInsert",r={editor:null,enabled:!0,addons:{images:!0,embeds:!0}};n.prototype.init=function(){this.$el.addClass("medium-editor-insert-plugin"),("object"!=typeof this.options.addons||0===Object.keys(this.options.addons).length)&&this.disable(),this.initAddons(),this.clean(),this.events()},n.prototype.events=function(){var i=this;this.$el.on("dragover drop",function(e){e.preventDefault()}).on("keyup click",e.proxy(this,"toggleButtons")).on("selectstart mousedown",".medium-insert, .medium-insert-buttons",e.proxy(this,"disableSelection")).on("click",".medium-insert-buttons-show",e.proxy(this,"toggleAddons")).on("click",".medium-insert-action",e.proxy(this,"addonAction")).on("paste",".medium-insert-caption-placeholder",function(t){e.proxy(i,"removeCaptionPlaceholder")(e(t.target))}),e(t).on("resize",e.proxy(this,"positionButtons",null))},n.prototype.getEditor=function(){return this.options.editor},n.prototype.editorSerialize=function(){var t=this._serialize();return e.each(t,function(i){var s=e("<div />").html(t[i].value);s.find(".medium-insert-buttons").remove(),t[i].value=s.html()}),t},n.prototype.editorDestroy=function(){e.each(this.elements,function(t,i){e(i).data("plugin_"+a).disable()}),this._destroy()},n.prototype.editorSetup=function(){this._setup(),e.each(this.elements,function(t,i){e(i).data("plugin_"+a).enable()})},n.prototype.editorUpdatePlaceholder=function(t){var i,s=e(t).clone();s.find(".medium-insert-buttons").remove(),i=s.html().replace(/^\s+|\s+$/g,"").replace(/^<p( class="medium-insert-active")?><br><\/p>$/,""),t.querySelector("img, blockquote")||""!==i?this.hidePlaceholder(t):(this.showPlaceholder(t),this.base._hideInsertButtons(e(t)))},n.prototype.triggerInput=function(){this.getEditor()&&this.getEditor().trigger("editableInput",null,this.el)},n.prototype.deselect=function(){i.getSelection().removeAllRanges()},n.prototype.disable=function(){this.options.enabled=!1,this.$el.find(".medium-insert-buttons").addClass("hide")},n.prototype.enable=function(){this.options.enabled=!0,this.$el.find(".medium-insert-buttons").removeClass("hide")},n.prototype.disableSelection=function(t){var i=e(t.target);(i.is("img")===!1||i.hasClass("medium-insert-buttons-show"))&&t.preventDefault()},n.prototype.initAddons=function(){var t=this;this.options.addons&&0!==this.options.addons.length&&e.each(this.options.addons,function(e,i){var s=a+o(e);return i===!1?void delete t.options.addons[e]:(t.$el[s](i),void(t.options.addons[e]=t.$el.data("plugin_"+s).options))})},n.prototype.clean=function(){var t,i,s,o=this;this.options.enabled!==!1&&((""===this.$el.html().trim()||"<br>"===this.$el.html().trim())&&this.$el.html(this.templates["src/js/templates/core-empty-line.hbs"]().trim()),s=this.$el.contents().filter(function(){return"#text"===this.nodeName&&""!==e.trim(e(this).text())}),s.each(function(){e(this).wrap("<p />"),o.moveCaret(e(this).parent(),e(this).text().length)}),this.addButtons(),t=this.$el.find(".medium-insert-buttons"),i=t.prev(),i.attr("class")&&i.attr("class").match(/medium\-insert(?!\-active)/)&&t.before(this.templates["src/js/templates/core-empty-line.hbs"]().trim()))},n.prototype.getButtons=function(){return this.options.enabled!==!1?this.templates["src/js/templates/core-buttons.hbs"]({addons:this.options.addons}).trim():void 0},n.prototype.addButtons=function(){0===this.$el.find(".medium-insert-buttons").length&&this.$el.append(this.getButtons())},n.prototype.toggleButtons=function(i){var s,o,n,a,r=e(i.target),l=t.getSelection(),d=this;this.options.enabled!==!1&&(l&&0!==l.rangeCount?(s=l.getRangeAt(0),o=e(s.commonAncestorContainer)):o=r,o.hasClass("medium-editor-insert-plugin")&&(o=o.find("p:first")),n=o.is("p")?o:o.closest("p"),this.clean(),r.hasClass("medium-editor-placeholder")===!1&&0===r.closest(".medium-insert-buttons").length&&0===o.closest(".medium-insert-buttons").length&&(this.$el.find(".medium-insert-active").removeClass("medium-insert-active"),e.each(this.options.addons,function(e){return r.closest(".medium-insert-"+e).length&&(o=r),o.closest(".medium-insert-"+e).length?(n=o.closest(".medium-insert-"+e),void(a=e)):void 0}),n.length&&(""===n.text().trim()&&!a||"images"===a)?(n.addClass("medium-insert-active"),setTimeout(function(){d.positionButtons(a),d.showButtons(a)},a?100:0)):this.hideButtons()))},n.prototype.showButtons=function(e){var t=this.$el.find(".medium-insert-buttons");t.show(),t.find("li").show(),e&&(t.find("li").hide(),t.find('a[data-addon="'+e+'"]').parent().show())},n.prototype.hideButtons=function(e){e=e||this.$el,e.find(".medium-insert-buttons").hide(),e.find(".medium-insert-buttons-addons").hide(),e.find(".medium-insert-buttons-show").removeClass("medium-insert-buttons-rotate")},n.prototype.positionButtons=function(e){var t,i,s=this.$el.find(".medium-insert-buttons"),o=this.$el.find(".medium-insert-active"),n=o.find("figure:first").length?o.find("figure:first"):o;o.length&&(t=o.position().left-parseInt(s.find(".medium-insert-buttons-addons").css("left"),10)-parseInt(s.find(".medium-insert-buttons-addons a:first").css("margin-left"),10),t=0>t?o.position().left:t,i=o.position().top+parseInt(o.css("margin-top"),10),e&&(o.position().left!==n.position().left&&(t=n.position().left),i+=o.height()+15),s.css({left:t,top:i}))},n.prototype.toggleAddons=function(){this.$el.find(".medium-insert-buttons-addons").fadeToggle(),this.$el.find(".medium-insert-buttons-show").toggleClass("medium-insert-buttons-rotate")},n.prototype.hideAddons=function(){this.$el.find(".medium-insert-buttons-addons").hide(),this.$el.find(".medium-insert-buttons-show").removeClass("medium-insert-buttons-rotate")},n.prototype.addonAction=function(t){var i=e(t.target).is("a")?e(t.target):e(t.target).closest("a"),s=i.data("addon"),n=i.data("action");this.$el.data("plugin_"+a+o(s))[n]()},n.prototype.moveCaret=function(e,s){var o,n,a;if(s=s||0,o=i.createRange(),n=t.getSelection(),a=e.get(0),!a.childNodes.length){var r=i.createTextNode(" ");a.appendChild(r)}o.setStart(a.childNodes[0],s),o.collapse(!0),n.removeAllRanges(),n.addRange(o)},n.prototype.addCaption=function(e,t){var i=e.find("figcaption");0===i.length&&e.append(this.templates["src/js/templates/core-caption.hbs"]({placeholder:t}))},n.prototype.removeCaptions=function(t){var i=this.$el.find("figcaption");t&&(i=i.not(t)),i.each(function(){(e(this).hasClass("medium-insert-caption-placeholder")||""===e(this).text().trim())&&e(this).remove()})},n.prototype.removeCaptionPlaceholder=function(e){var t=e.is("figcaption")?e:e.find("figcaption");t.length&&t.removeClass("medium-insert-caption-placeholder").removeAttr("data-placeholder")},e.fn[a]=function(t){return this.each(function(){var i,s=this;e(s).is("textarea")&&(i=e(s).attr("medium-editor-textarea-id"),s=e(s).siblings('[medium-editor-textarea-id="'+i+'"]').get(0)),e.data(s,"plugin_"+a)?"string"==typeof t&&e.data(s,"plugin_"+a)[t]&&e.data(s,"plugin_"+a)[t]():(e.data(s,"plugin_"+a,new n(s,t)),e.data(s,"plugin_"+a).init())})}}(jQuery,window,document),function(e,t,i,s){"use strict";function o(i,s){this.el=i,this.$el=e(i),this.templates=t.MediumInsert.Templates,this.core=this.$el.data("plugin_"+n),this.options=e.extend(!0,{},r,s),this._defaults=r,this._name=n,this.core.getEditor()&&(this.core.getEditor()._serializePreEmbeds=this.core.getEditor().serialize,this.core.getEditor().serialize=this.editorSerialize),this.init()}var n="mediumInsert",a="Embeds",r={label:'<span class="fa fa-youtube-play"></span>',placeholder:"Paste a YouTube, Vimeo, Facebook, Twitter or Instagram link and press Enter",oembedProxy:"http://medium.iframe.ly/api/oembed?iframe=1",captions:!0,captionPlaceholder:"Type caption (optional)",styles:{wide:{label:'<span class="fa fa-align-justify"></span>'},left:{label:'<span class="fa fa-align-left"></span>'},right:{label:'<span class="fa fa-align-right"></span>'}},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(){var t=e.Event("keydown");t.which=8,e(i).trigger(t)}}}};o.prototype.init=function(){var t=this.$el.find(".medium-insert-embeds");t.attr("contenteditable",!1),t.each(function(){0===e(this).find(".medium-insert-embeds-overlay").length&&e(this).append(e("<div />").addClass("medium-insert-embeds-overlay"))}),this.events(),this.backwardsCompatibility()},o.prototype.events=function(){e(i).on("click",e.proxy(this,"unselectEmbed")).on("keydown",e.proxy(this,"removeEmbed")).on("click",".medium-insert-embeds-toolbar .medium-editor-action",e.proxy(this,"toolbarAction")).on("click",".medium-insert-embeds-toolbar2 .medium-editor-action",e.proxy(this,"toolbar2Action")),this.$el.on("keyup click paste",e.proxy(this,"togglePlaceholder")).on("keydown",e.proxy(this,"processLink")).on("click",".medium-insert-embeds-overlay",e.proxy(this,"selectEmbed")).on("contextmenu",".medium-insert-embeds-placeholder",e.proxy(this,"fixRightClickOnPlaceholder"))},o.prototype.backwardsCompatibility=function(){var t=this;this.$el.find(".mediumInsert-embeds").removeClass("mediumInsert-embeds").addClass("medium-insert-embeds"),this.$el.find(".medium-insert-embeds").each(function(){0===e(this).find(".medium-insert-embed").length&&(e(this).after(t.templates["src/js/templates/embeds-wrapper.hbs"]({html:e(this).html()})),e(this).remove())})},o.prototype.editorSerialize=function(){var t=this._serializePreEmbeds();return e.each(t,function(i){var s=e("<div />").html(t[i].value);s.find(".medium-insert-embeds").removeAttr("contenteditable"),s.find(".medium-insert-embeds-overlay").remove(),t[i].value=s.html()}),t},o.prototype.add=function(){var e=this.$el.find(".medium-insert-active");e.html(this.templates["src/js/templates/core-empty-line.hbs"]().trim()),e.is("p")&&(e.replaceWith('<div class="medium-insert-active">'+e.html()+"</div>"),e=this.$el.find(".medium-insert-active"),this.core.moveCaret(e)),e.addClass("medium-insert-embeds medium-insert-embeds-input medium-insert-embeds-active"),this.togglePlaceholder({target:e.get(0)}),e.click(),this.core.hideButtons()},o.prototype.togglePlaceholder=function(i){var s,o,n,a=e(i.target),r=t.getSelection();r&&0!==r.rangeCount&&(s=r.getRangeAt(0),o=e(s.commonAncestorContainer),o.hasClass("medium-insert-embeds-active")?a=o:o.closest(".medium-insert-embeds-active").length&&(a=o.closest(".medium-insert-embeds-active")),a.hasClass("medium-insert-embeds-active")?(n=a.text().trim(),""===n&&a.hasClass("medium-insert-embeds-placeholder")===!1?a.addClass("medium-insert-embeds-placeholder").attr("data-placeholder",this.options.placeholder):""!==n&&a.hasClass("medium-insert-embeds-placeholder")&&a.removeClass("medium-insert-embeds-placeholder").removeAttr("data-placeholder")):this.$el.find(".medium-insert-embeds-active").remove())},o.prototype.fixRightClickOnPlaceholder=function(t){this.core.moveCaret(e(t.target))},o.prototype.processLink=function(e){var t,i=this.$el.find(".medium-insert-embeds-active");if(i.length)return t=i.text().trim(),""===t&&-1!==[8,46,13].indexOf(e.which)?void i.remove():void(13===e.which&&(e.preventDefault(),e.stopPropagation(),this.options.oembedProxy?this.oembed(t):this.parseUrl(t)))},o.prototype.oembed=function(i){var s=this;e.support.cors=!0,e.ajax({crossDomain:!0,cache:!1,url:this.options.oembedProxy,dataType:"json",data:{url:i},success:function(t){var i=t&&t.html;t&&!t.html&&"photo"===t.type&&t.url&&(i='<img src="'+t.url+'" alt="">'),e.proxy(s,"embed",i)()},error:function(o,n,a){var r=function(){try{return JSON.parse(o.responseText)}catch(e){}}();"undefined"!=typeof t.console?t.console.log(r&&r.error||o.status||a.message):t.alert("Error requesting media from "+s.options.oembedProxy+" to insert: "+a+" (response status: "+o.status+")"),e.proxy(s,"convertBadEmbed",i)()}})},o.prototype.parseUrl=function(t){var i;return new RegExp(["youtube","youtu.be","vimeo","instagram"].join("|")).test(t)?(i=t.replace(/\n?/g,"").replace(/^((http(s)?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/(watch\?v=|v\/)?)([a-zA-Z0-9\-_]+)(.*)?$/,'<div class="video video-youtube"><iframe width="420" height="315" src="//www.youtube.com/embed/$7" frameborder="0" allowfullscreen></iframe></div>').replace(/^https?:\/\/vimeo\.com(\/.+)?\/([0-9]+)$/,'<div class="video video-vimeo"><iframe src="//player.vimeo.com/video/$2" width="500" height="281" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>').replace(/^https?:\/\/instagram\.com\/p\/(.+)\/?$/,'<span class="instagram"><iframe src="//instagram.com/p/$1/embed/" width="612" height="710" frameborder="0" scrolling="no" allowtransparency="true"></iframe></span>'),void this.embed(/<("[^"]*"|'[^']*'|[^'">])*>/.test(i)?i:!1)):(e.proxy(this,"convertBadEmbed",t)(),!1)},o.prototype.embed=function(e){var t=this.$el.find(".medium-insert-embeds-active");return e?(t.after(this.templates["src/js/templates/embeds-wrapper.hbs"]({html:e})),t.remove(),this.core.triggerInput(),-1!==e.indexOf("facebook")&&"undefined"!=typeof FB&&setTimeout(function(){FB.XFBML.parse()},2e3),void 0):(alert("Incorrect URL format specified"),!1)},o.prototype.convertBadEmbed=function(t){var i,s,o,n=this.templates["src/js/templates/core-empty-line.hbs"]().trim();i=this.$el.find(".medium-insert-embeds-active"),o=e(n),i.before(o),i.remove(),o.html(t),s=e(n),o.after(s),this.core.triggerInput(),this.core.moveCaret(i)},o.prototype.selectEmbed=function(t){if(this.core.options.enabled){var i=e(t.target).hasClass("medium-insert-embeds")?e(t.target):e(t.target).closest(".medium-insert-embeds"),s=this;i.addClass("medium-insert-embeds-selected"),setTimeout(function(){s.addToolbar(),s.options.captions&&s.core.addCaption(i.find("figure"),s.options.captionPlaceholder)},50)}},o.prototype.unselectEmbed=function(t){var i=e(t.target).hasClass("medium-insert-embeds")?e(t.target):e(t.target).closest(".medium-insert-embeds"),s=this.$el.find(".medium-insert-embeds-selected");return i.hasClass("medium-insert-embeds-selected")?(s.not(i).removeClass("medium-insert-embeds-selected"),e(".medium-insert-embeds-toolbar, .medium-insert-embeds-toolbar2").remove(),this.core.removeCaptions(i.find("figcaption")),void((e(t.target).is(".medium-insert-caption-placeholder")||e(t.target).is("figcaption"))&&(i.removeClass("medium-insert-embeds-selected"),this.core.removeCaptionPlaceholder(i.find("figure"))))):(s.removeClass("medium-insert-embeds-selected"),e(".medium-insert-embeds-toolbar, .medium-insert-embeds-toolbar2").remove(),void(e(t.target).is(".medium-insert-caption-placeholder")?this.core.removeCaptionPlaceholder(i.find("figure")):e(t.target).is("figcaption")===!1&&this.core.removeCaptions()))},o.prototype.removeEmbed=function(t){var i,s;(8===t.which||46===t.which)&&(i=this.$el.find(".medium-insert-embeds-selected"),i.length&&(t.preventDefault(),e(".medium-insert-embeds-toolbar, .medium-insert-embeds-toolbar2").remove(),s=e(this.templates["src/js/templates/core-empty-line.hbs"]().trim()),i.before(s),i.remove(),this.core.hideAddons(),this.core.moveCaret(s),this.core.triggerInput()))},o.prototype.addToolbar=function(){var t,i,s,o=this.$el.find(".medium-insert-embeds-selected"),n=!1;if(0!==o.length){var a=this.core.getEditor(),r=a.options.elementsContainer||"body";e(r).append(this.templates["src/js/templates/embeds-toolbar.hbs"]({styles:this.options.styles,actions:this.options.actions}).trim()),t=e(".medium-insert-embeds-toolbar"),i=e(".medium-insert-embeds-toolbar2"),s=o.offset().top-t.height()-8-2-5,0>s&&(s=0),t.css({top:s,left:o.offset().left+o.width()/2-t.width()/2}).show(),i.css({top:o.offset().top+2,left:o.offset().left+o.width()-i.width()-4}).show(),t.find("button").each(function(){o.hasClass("medium-insert-embeds-"+e(this).data("action"))&&(e(this).addClass("medium-editor-button-active"),n=!0)}),n===!1&&t.find("button").first().addClass("medium-editor-button-active")}},o.prototype.toolbarAction=function(t){var i=e(t.target).is("button")?e(t.target):e(t.target).closest("button"),s=i.closest("li"),o=s.closest("ul"),n=o.find("li"),a=this.$el.find(".medium-insert-embeds-selected"),r=this;i.addClass("medium-editor-button-active"),s.siblings().find(".medium-editor-button-active").removeClass("medium-editor-button-active"),n.find("button").each(function(){var t="medium-insert-embeds-"+e(this).data("action");e(this).hasClass("medium-editor-button-active")?(a.addClass(t),r.options.styles[e(this).data("action")].added&&r.options.styles[e(this).data("action")].added(a)):(a.removeClass(t),r.options.styles[e(this).data("action")].removed&&r.options.styles[e(this).data("action")].removed(a))}),this.core.triggerInput()},o.prototype.toolbar2Action=function(t){var i=e(t.target).is("button")?e(t.target):e(t.target).closest("button"),s=this.options.actions[i.data("action")].clicked;s&&s(this.$el.find(".medium-insert-embeds-selected")),this.core.triggerInput()},e.fn[n+a]=function(t){return this.each(function(){e.data(this,"plugin_"+n+a)||e.data(this,"plugin_"+n+a,new o(this,t))})}}(jQuery,window,document),function(e,t,i,s,o){"use strict";function n(i,s){this.el=i,this.$el=e(i),this.templates=t.MediumInsert.Templates,this.core=this.$el.data("plugin_"+a),this.options=e.extend(!0,{},l,s),this._defaults=l,this._name=a,this.options.preview&&!t.FileReader&&(this.options.preview=!1),this.core.getEditor()&&(this.core.getEditor()._serializePreImages=this.core.getEditor().serialize,this.core.getEditor().serialize=this.editorSerialize),this.init()}var a="mediumInsert",r="Images",l={label:'<span class="fa fa-camera"></span>',deleteMethod:"POST",deleteScript:"delete.php",preview:!0,captions:!0,captionPlaceholder:"Type caption for image (optional)",autoGrid:3,fileUploadOptions:{url:"upload.php",acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i},styles:{wide:{label:'<span class="fa fa-align-justify"></span>'},left:{label:'<span class="fa fa-align-left"></span>'},right:{label:'<span class="fa fa-align-right"></span>'},grid:{label:'<span class="fa fa-th"></span>'}},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(){var t=e.Event("keydown");t.which=8,e(i).trigger(t)}}},sorting:function(){var t=this;e(".medium-insert-images").sortable({group:"medium-insert-images",containerSelector:".medium-insert-images",itemSelector:"figure",placeholder:'<figure class="placeholder">',handle:"img",nested:!1,vertical:!1,afterMove:function(){t.core.triggerInput()}})},messages:{acceptFileTypesError:"This file is not in a supported format: ",maxFileSizeError:"This file is too big: "}};n.prototype.init=function(){var e=this.$el.find(".medium-insert-images");e.find("figcaption").attr("contenteditable",!0),e.find("figure").attr("contenteditable",!1),this.events(),this.backwardsCompatibility(),this.sorting()},n.prototype.events=function(){e(i).on("click",e.proxy(this,"unselectImage")).on("keydown",e.proxy(this,"removeImage")).on("click",".medium-insert-images-toolbar .medium-editor-action",e.proxy(this,"toolbarAction")).on("click",".medium-insert-images-toolbar2 .medium-editor-action",e.proxy(this,"toolbar2Action")),this.$el.on("click",".medium-insert-images img",e.proxy(this,"selectImage"))},n.prototype.backwardsCompatibility=function(){this.$el.find(".mediumInsert").removeClass("mediumInsert").addClass("medium-insert-images"),this.$el.find(".medium-insert-images.small").removeClass("small").addClass("medium-insert-images-left")},n.prototype.editorSerialize=function(){var t=this._serializePreImages();return e.each(t,function(i){var s=e("<div />").html(t[i].value);s.find(".medium-insert-images").find("figcaption, figure").removeAttr("contenteditable"),t[i].value=s.html()}),t},n.prototype.add=function(){var t=this,i=e(this.templates["src/js/templates/images-fileupload.hbs"]()),s={dataType:"json",add:function(i,s){e.proxy(t,"uploadAdd",i,s)()},done:function(i,s){e.proxy(t,"uploadDone",i,s)()}};(new XMLHttpRequest).upload&&(s.progress=function(i,s){e.proxy(t,"uploadProgress",i,s)()},s.progressall=function(i,s){e.proxy(t,"uploadProgressall",i,s)()}),i.fileupload(e.extend(!0,{},this.options.fileUploadOptions,s)),i.click()},n.prototype.uploadAdd=function(t,i){var s,o=this.$el.find(".medium-insert-active"),n=this,a=[],r=i.files[0],l=this.options.fileUploadOptions.acceptFileTypes,d=this.options.fileUploadOptions.maxFileSize;return l&&!l.test(r.type)?a.push(this.options.messages.acceptFileTypesError+r.name):d&&r.size>d&&a.push(this.options.messages.maxFileSizeError+r.name),a.length>0?void alert(a.join("\n")):(this.core.hideButtons(),o.is("p")&&(o.replaceWith('<div class="medium-insert-active">'+o.html()+"</div>"),o=this.$el.find(".medium-insert-active"),this.core.moveCaret(o)),o.addClass("medium-insert-images"),this.options.preview===!1&&0===o.find("progress").length&&(new XMLHttpRequest).upload&&o.append(this.templates["src/js/templates/images-progressbar.hbs"]()),void((i.autoUpload||i.autoUpload!==!1&&e(t.target).fileupload("option","autoUpload"))&&i.process().done(function(){n.options.preview?(s=new FileReader,s.onload=function(t){e.proxy(n,"showImage",t.target.result,i)()},s.readAsDataURL(i.files[0])):i.submit()})))},n.prototype.uploadProgressall=function(e,t){var i,s;this.options.preview===!1&&(i=parseInt(t.loaded/t.total*100,10),s=this.$el.find(".medium-insert-active").find("progress"),s.attr("value",i).text(i),100===i&&s.remove())},n.prototype.uploadProgress=function(e,t){var i,s;this.options.preview&&(i=100-parseInt(t.loaded/t.total*100,10),s=t.context.find(".medium-insert-images-progress"),s.css("width",i+"%"),0===i&&s.remove())},n.prototype.uploadDone=function(t,i){var s=e.proxy(this,"showImage",i.result.files[0].url,i)();this.core.clean(),this.sorting(),this.options.uploadCompleted&&this.options.uploadCompleted(s,i)},n.prototype.showImage=function(t,i){var s,o,n=this.$el.find(".medium-insert-active");return n.click(),o=this,this.options.preview&&i.context?(s=this.getDOMImage(),s.onload=function(){i.context.find("img").attr("src",s.src),o.core.triggerInput()},s.src=t):(i.context=e(this.templates["src/js/templates/images-image.hbs"]({img:t,progress:this.options.preview})).appendTo(n),n.find("br").remove(),this.options.autoGrid&&n.find("figure").length>=this.options.autoGrid&&(e.each(this.options.styles,function(e,t){var i="medium-insert-images-"+e;n.removeClass(i),t.removed&&t.removed(n)}),n.addClass("medium-insert-images-grid"),this.options.styles.grid.added&&this.options.styles.grid.added(n)),this.options.preview&&i.submit()),this.core.triggerInput(),i.context},n.prototype.getDOMImage=function(){return new t.Image},n.prototype.selectImage=function(t){if(this.core.options.enabled){var i=e(t.target),s=this;this.$el.blur(),i.addClass("medium-insert-image-active"),i.closest(".medium-insert-images").addClass("medium-insert-active"),setTimeout(function(){s.addToolbar(),s.options.captions&&s.core.addCaption(i.closest("figure"),s.options.captionPlaceholder)},50)}},n.prototype.unselectImage=function(t){var i=e(t.target),s=this.$el.find(".medium-insert-image-active");return i.is("img")&&i.hasClass("medium-insert-image-active")?(s.not(i).removeClass("medium-insert-image-active"),e(".medium-insert-images-toolbar, .medium-insert-images-toolbar2").remove(),void this.core.removeCaptions(i)):(s.removeClass("medium-insert-image-active"),e(".medium-insert-images-toolbar, .medium-insert-images-toolbar2").remove(),void(i.is(".medium-insert-caption-placeholder")?this.core.removeCaptionPlaceholder(s.closest("figure")):i.is("figcaption")===!1&&this.core.removeCaptions()))},n.prototype.removeImage=function(t){var i,s,o;(8===t.which||46===t.which)&&(i=this.$el.find(".medium-insert-image-active"),i.length&&(t.preventDefault(),this.deleteFile(i.attr("src")),s=i.closest(".medium-insert-images"),i.closest("figure").remove(),e(".medium-insert-images-toolbar, .medium-insert-images-toolbar2").remove(),0===s.find("figure").length&&(o=s.next(),(o.is("p")===!1||""!==o.text())&&(o=e(this.templates["src/js/templates/core-empty-line.hbs"]().trim()),s.before(o)),s.remove(),this.core.hideAddons(),this.core.moveCaret(o)),this.core.triggerInput()))},n.prototype.deleteFile=function(t){if(this.options.deleteScript){var i=this.options.deleteMethod||"POST";e.ajax({url:this.options.deleteScript,type:i,data:{file:t}})}},n.prototype.addToolbar=function(){var t,i,s,o=this.$el.find(".medium-insert-image-active"),n=o.closest(".medium-insert-images"),a=!1,r=this.core.getEditor(),l=r.options.elementsContainer||"body";
e(l).append(this.templates["src/js/templates/images-toolbar.hbs"]({styles:this.options.styles,actions:this.options.actions}).trim()),t=e(".medium-insert-images-toolbar"),i=e(".medium-insert-images-toolbar2"),s=o.offset().top-t.height()-8-2-5,0>s&&(s=0),t.css({top:s,left:o.offset().left+o.width()/2-t.width()/2}).show(),i.css({top:o.offset().top+2,left:o.offset().left+o.width()-i.width()-4}).show(),t.find("button").each(function(){n.hasClass("medium-insert-images-"+e(this).data("action"))&&(e(this).addClass("medium-editor-button-active"),a=!0)}),a===!1&&t.find("button").first().addClass("medium-editor-button-active")},n.prototype.toolbarAction=function(t){var i=e(t.target).is("button")?e(t.target):e(t.target).closest("button"),s=i.closest("li"),o=s.closest("ul"),n=o.find("li"),a=this.$el.find(".medium-insert-active"),r=this;i.addClass("medium-editor-button-active"),s.siblings().find(".medium-editor-button-active").removeClass("medium-editor-button-active"),n.find("button").each(function(){var t="medium-insert-images-"+e(this).data("action");e(this).hasClass("medium-editor-button-active")?(a.addClass(t),r.options.styles[e(this).data("action")].added&&r.options.styles[e(this).data("action")].added(a)):(a.removeClass(t),r.options.styles[e(this).data("action")].removed&&r.options.styles[e(this).data("action")].removed(a))}),this.core.hideButtons(),this.core.triggerInput()},n.prototype.toolbar2Action=function(t){var i=e(t.target).is("button")?e(t.target):e(t.target).closest("button"),s=this.options.actions[i.data("action")].clicked;s&&s(this.$el.find(".medium-insert-image-active")),this.core.hideButtons(),this.core.triggerInput()},n.prototype.sorting=function(){e.proxy(this.options.sorting,this)()},e.fn[a+r]=function(t){return this.each(function(){e.data(this,"plugin_"+a+r)||e.data(this,"plugin_"+a+r,new n(this,t))})}}(jQuery,window,document,MediumEditor.util);